---

title: Utilities

keywords: fastai
sidebar: home_sidebar

summary: "This module defines several utility functions. Mainly binning-related."
description: "This module defines several utility functions. Mainly binning-related."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_bin_indices" class="doc_header"><code>get_bin_indices</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/utils.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_bin_indices</code>(<strong><code>y_probs</code></strong>:<code>array</code>, <strong><code>bins</code></strong>=<em><code>'fd'</code></em>, <strong><code>lower</code></strong>:<code>float</code>=<em><code>None</code></em>, <strong><code>upper</code></strong>:<code>float</code>=<em><code>None</code></em>, <strong><code>return_edges</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>n_bins</code></strong>:<code>int</code>=<em><code>10</code></em>)</p>
</blockquote>
<p>Compute a function across.</p>
<p>Parameters:
y_probs -- Predicted class probabilities
bins -- Number of bins (see <code>np.histogram_bin_edges</code> for options)
return_edges -- Return the edges used for the binning
lower -- Lower bound of confidence values
upper -- Upper bound of confidence values
return_edges -- Set to return identified edges</p>
<p>Returns:
bin_indices (np.array) -- Array that maps instances to bins
edges (np.array) -- Bin edges if return_edges is True</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="binning" class="doc_header"><code>binning</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/utils.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>binning</code>(<strong><code>y_probs</code></strong>:<code>array</code>, <strong><code>y_preds</code></strong>:<code>array</code>, <strong><code>y_true</code></strong>:<code>array</code>, <strong><code>bin_indices</code></strong>:<code>array</code>, <strong><code>bin_func</code></strong>:<code>Callable</code>)</p>
</blockquote>
<p>Compute a function across bins of confidence levels.</p>
<p>Parameters:
y_probs -- Predicted class probabilities
y_preds -- Predicted class labels
y_true -- True class labels
bin_indices -- Array that maps instances to bins (as obtained by <code>utils.get_bin_indices</code>)
bin_func -- Function to compute for each bin</p>
<p>Returns:
result (float) -- Result of the computation across bins</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">indices</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">get_bin_indices</span><span class="p">(</span><span class="n">y_probs</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">return_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

