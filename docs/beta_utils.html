---

title: Beta distribution utilities

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/beta_utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_beta_parameters" class="doc_header"><code>get_beta_parameters</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L19" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_beta_parameters</code>(<strong><code>confusion</code></strong>)</p>
</blockquote>
<p>Extract the beta parameters from a confusion matrix.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>confusion : array, shape = [n_classes, n<em>classes]
    Where entry c</em>{ij} is the number of observations in class i but
    are classified as class j.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>parameters: array of tuples
    Each tuple (alpha_i, beta_i) is the parameters of a Beta distribution
    that corresponds to class i.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="convolve_betas_fft" class="doc_header"><code>convolve_betas_fft</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>convolve_betas_fft</code>(<strong><code>parameters</code></strong>, <strong><code>res</code></strong>=<em><code>0.001</code></em>)</p>
</blockquote>
<p>Convolve a list of 1d float arrays together, using FFTs.
The arrays need not have the same length, but each array should
have length at least 1.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="convolve_betas" class="doc_header"><code>convolve_betas</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L86" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>convolve_betas</code>(<strong><code>parameters</code></strong>, <strong><code>res</code></strong>=<em><code>0.001</code></em>)</p>
</blockquote>
<p>Convolves k Beta distributions.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>parameters : array of tuples
    Each tuple (alpha_i, beta_i) is the parameters of a Beta distribution.</p>
<p>res : float, optional (default=0.001)
    The precision of the resulting convolution, measured as step size in
    the support.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>convolution : array, shape = [k / res]
    The resulting convultion of the k Beta distributions, given the
    specified presicion <code>res</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="balanced_accuracy_expected" class="doc_header"><code>balanced_accuracy_expected</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L130" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>balanced_accuracy_expected</code>(<strong><code>confusion</code></strong>, <strong><code>fft</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the expected value of the posterior balanced accuracy.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>confusion : array, shape = [n_classes, n<em>classes]
    Where entry c</em>{ij} is the number of observations in class i but
    are classified as class j.
fft: bool
    Use efficient fft convolution</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>bal_accuracy_expected: float</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="beta_sum_pdf" class="doc_header"><code>beta_sum_pdf</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L166" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>beta_sum_pdf</code>(<strong><code>x</code></strong>, <strong><code>parameters</code></strong>, <strong><code>res</code></strong>=<em><code>0.001</code></em>, <strong><code>fft</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the pdf of the sum of beta distributions.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>x : array
    A subset of the domain where we want evaluate the pdf.</p>
<p>parameters : array of tuples
    Each tuple (alpha_i, beta_i) is the parameters of a Beta distribution.</p>
<p>res : float, optional (default=0.001)
    The precision of the convolution, measured as step size in
    the support.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>y : array
    The pdf evaulated at x.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="beta_avg_pdf" class="doc_header"><code>beta_avg_pdf</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L213" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>beta_avg_pdf</code>(<strong><code>x</code></strong>, <strong><code>parameters</code></strong>, <strong><code>res</code></strong>=<em><code>0.001</code></em>, <strong><code>fft</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Compute the pdf of the average of the k beta distributions.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>x : array
    A subset of the domain where we want evaluate the pdf.</p>
<p>parameters : array of tuples
    Each tuple (alpha_i, beta_i) is the parameters of a Beta distribution.</p>
<p>res : float, optional (default=0.001)
    The precision of the convolution, measured as step size in
    the support.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>y : array
    The pdf evaulated at x.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="beta_sum_cdf" class="doc_header"><code>beta_sum_cdf</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L241" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>beta_sum_cdf</code>(<strong><code>x</code></strong>, <strong><code>parameters</code></strong>, <strong><code>res</code></strong>=<em><code>0.001</code></em>)</p>
</blockquote>
<p>Compute the cdf of the sum of the k beta distributions.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>x : array
    A subset of the domain where we want evaluate the cdf.</p>
<p>parameters : array of tuples
    Each tuple (alpha_i, beta_i) is the parameters of a Beta distribution.</p>
<p>res : float, optional (default=0.001)
    The precision of the convolution, measured as step size in
    the support.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>y : array
    The cdf evaulated at x.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="beta_avg_cdf" class="doc_header"><code>beta_avg_cdf</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L277" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>beta_avg_cdf</code>(<strong><code>x</code></strong>, <strong><code>parameters</code></strong>, <strong><code>res</code></strong>=<em><code>0.001</code></em>)</p>
</blockquote>
<p>Compute the cdf of the average of the k beta distributions.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>x : array
    A subset of the domain where we want evaluate the cdf.</p>
<p>parameters : array of tuples
    Each tuple (alpha_i, beta_i) is the parameters of a Beta distribution.</p>
<p>res : float, optional (default=0.001)
    The precision of the convolution, measured as step size in
    the support.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>y : array
    The cdf evaulated at x.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="beta_avg_inv_cdf" class="doc_header"><code>beta_avg_inv_cdf</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L305" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>beta_avg_inv_cdf</code>(<strong><code>y</code></strong>, <strong><code>parameters</code></strong>, <strong><code>res</code></strong>=<em><code>0.001</code></em>)</p>
</blockquote>
<p>Compute the inverse cdf of the average of the k beta distributions.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>y : float
    A float between 0 and 1 (the range of the cdf)</p>
<p>parameters : array of tuples
    Each tuple (alpha_i, beta_i) is the parameters of a Beta distribution.</p>
<p>res : float, optional (default=0.001)
    The precision of the convolution, measured as step size in
    the support.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>x : float
    the inverse cdf of y</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="recall" class="doc_header"><code>recall</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L329" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>recall</code>(<strong><code>confusion</code></strong>)</p>
</blockquote>
<p>Compute the recall from a confusion matrix.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>confusion : array, shape = [n_classes, n<em>classes]
    Where entry c</em>{ij} is the number of observations in class i but
    are classified as class j.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>recalls : array
    A list of recalls, one for each class.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="precision" class="doc_header"><code>precision</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L355" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>precision</code>(<strong><code>confusion</code></strong>, <strong><code>classes</code></strong>, <strong><code>classifiers</code></strong>)</p>
</blockquote>
<p>Compute the precision from a confusion matrix.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>confusion : array, shape = [n_classes, n<em>classes]
    Where entry c</em>{ij} is the number of observations in class i but
    are classified as class j.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>precisions : array
    A list of precisions, one for each class.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mpba_score" class="doc_header"><code>mpba_score</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L381" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mpba_score</code>(<strong><code>y_true</code></strong>, <strong><code>y_pred</code></strong>)</p>
</blockquote>
<p>Compute the MPBA score of a classifier based on some test set.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>y_true : array
    Ground truth (correct) labels.</p>
<p>y_pred : array
    Predicted labels, as returned by a classifier.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>balanced_accuracy_expected : float
    The expected balanced accuracy rate on the test set.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="micro_f1_score" class="doc_header"><code>micro_f1_score</code><a href="https://github.com/MaximLippeveld/ridgereliability/tree/master/ridgereliability/beta.py#L403" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>micro_f1_score</code>(<strong><code>y_true</code></strong>, <strong><code>y_pred</code></strong>, <strong><code>n_classes</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Compute the Micro-F1 score of a classifier based on some test set.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>y_true : array
    Ground truth (correct) labels.</p>
<p>y_pred : array
    Predicted labels, as returned by a classifier.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns"> </a></h2><p>f1_score : float
    The F1 score on the test set.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

